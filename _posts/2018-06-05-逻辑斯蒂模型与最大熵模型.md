##  逻辑斯蒂模型
### 逻辑斯蒂分布的定义
对于连续随机变量X，如果X具有下列分布函数和密度函数:

$$ 
F(x) = P(X\leqslant x) = \frac{1}{1 + e^{-(x-\mu)/ \gamma}} \tag{1}\label{1}
$$

$$ 
f(x) = F^{'}(x) = \frac{e^{-(x - \mu )/\gamma }}{\gamma(1 +e ^{-(x - \mu )/\gamma})^{2}} \tag{2}\label{2}
$$

其中，$\mu$为位置参数，$\gamma>0$ 为形状参数，我们则称X服从逻辑斯蒂分布
### 二项逻辑斯蒂回归模型
二项逻辑斯蒂回归模型是一种分类模型。它具有如下的条件概率分布:

$$
P(Y = 1|x) = \frac{exp(\omega \cdot x + b)}{1 + exp(\omega \cdot x + b)} \tag{3}
$$

$$
P(Y = 0|x) = \frac{exp(\omega \cdot x + b)}{1 + exp(\omega \cdot x + b)} \tag{4}
$$ 

其中输入向量为 $x \in R^{n}$， 输出为$Y \in \\{0, 1\\}$, $w \in R^{n}$ 和 $b \in R$是参数，分别为权值向量和偏置， $w\cdot x$ 为$w$ 和 $x$的内积。  

方便起见，我们对权值向量$w$ 和输入向量$x$进行**扩充**，即：  

$$ w = (w^{(1)}, w^{(2)}, \cdots,w^{(n)},b)^{T} $$

$$ x = (x^{(1)}, x^{(2)}, \cdots,x^{(n)},1)^{T} $$ 

此时，逻辑斯蒂回归模型可写为：  
$$
P(Y = 1|x) = \frac{exp(\omega \cdot x)}{1 + exp(\omega \cdot x)} \tag{5}
$$

$$
P(Y = 0|x) = \frac{exp(\omega \cdot x)}{1 + exp(\omega \cdot x)} \tag{6}
$$ 

对于该模型来说，我们最终会把实例x分到概率值较高的那一类。

同时，我们引入**几率**一词，从另一角度看逻辑斯蒂回归模型。按照几率的定义，如果一个事件发生概率为$p$，那么该事件发生的几率则是 $\frac{p}{1-p}$ ,该事件的对数几率为：

$$ 
logit(p) = \log \frac{p}{1-p} 
$$

由式子（5）和（6）我们得知，逻辑斯蒂回归模型的某事件发生的对数几率为:  

$$ 
\log \frac{P(Y = 1|x)}{1 - P(Y = 1|x)} = w \cdot x
$$

由此我们可以知道，对于逻辑斯蒂回归模型，输出Y = 1的对数几率是输入$x$ 的线性函数表示的模型
### 模型参数估计
对于逻辑斯蒂回归模型的参数，我们采用**极大似然估计法**来估计模型的参数
具体推导如下：  
我们假设

$$ 
P(Y = 1 | x) = 1 - Q(x) 
$$ 

那么

$$ 
P(Y = 0 | x) = 1 - Q(x) 
$$

则似然函数为：

$$ 
\prod_{i = 1}^{N}[Q(x_i))]^{y_i}[1 - Q(x_i))]^{y_i} 
$$

对数似然函数为：

$$ 
\begin{align} 
L(w) & = \sum_{i = 1}^{N}[y_i \log Q(x_i) + (1 - y_i)log(1-Q(x_i))] \\ 
  & = \sum_{i = 1}^{N}[y_i \cdot \log \frac{1 - Q(x_i)}{Q(x_i)} + log(1-Q(x_i))] \\
  & = \sum_{i =1}^{N}[y_i(w \cdot x) - \log (1 + exp(w \cdot x_i))]
\end{align}
$$

然后我们对 $L(w)$ 求极大值（通常采用梯度下降法和拟牛顿法），得到 $w$ 的估计值
### 逻辑斯蒂回归模型的推广
在章节1.2中我们介绍的二项逻辑斯蒂回归模型可应用于二分类问题，对于此，我们可以将它推广到多项逻辑斯蒂回归模型，使其可用于解决多分类问题。

$$
P(Y = k | x) = \frac{exp(w_k \cdot x)}{1 + \sum_{k = 1}^{K - 1}exp(w_k \cdot x)} 
$$

$$
P(Y = k | x) = \frac{1}{1 + \sum_{k = 1}^{K - 1}exp(w_k \cdot x)} 
$$

其中 $Y \in \{1, 2, \cdots, K\}$ , $k = 1, 2,\cdots, K - 1$
